# PM Inventory System V4 - Developer Guide

## Project Status: ‚úÖ **ADMIN INTERFACE COMPLETE & OPTIMIZED WITH TOAST NOTIFICATIONS & MOBILE RESPONSIVE TABLE & SALES CHANNEL BUTTONS & COLLAPSIBLE SECTIONS**

**Last Updated:** (no date needed)
**Current Phase:** Collapsible Sections Implementation Complete

---

## üìã **Project Overview**

PM Inventory System V4 is a comprehensive inventory management solution built with modern web technologies, featuring a streamlined admin interface optimized for performance and user experience, now enhanced with floating toast notifications.

---

## üéØ **Completed Components**

### ‚úÖ **Core Admin Interface**
- **Connection Management**: Minimal connection status display with test functionality
- **Receiving System**: Add new stock with dynamic product search (collapsible section)
- **Transfer System**: Move stock between locations with swap-horiz icon (collapsible section)
- **Adjustment System**: Set exact stock levels with current stock display (collapsible section)
- **Sales System**: Bulk sales processing with dynamic table and sales channel integration (collapsible section)
- **Quick Inventory Check**: Inventory snapshot display (non-collapsible, as requested)

### ‚úÖ **Toast Notification System** üÜï
- **Floating Toast Notifications**: Pill-shaped notifications at bottom of screen
- **Single-Line Design**: Concise, space-efficient messages
- **Dark Gray Theme**: Professional dark background (#1a1a1a) with white text
- **Green Circled Tick Icons**: Success indicators with circled checkmark design
- **Auto-Fade**: Automatically disappear after 5 seconds
- **Duplicate Prevention**: Smart deduplication system prevents multiple identical toasts
- **Maximum 3 Toasts**: Keeps screen clean and uncluttered
- **Centered Positioning**: Horizontally centered on all screen sizes
- **Dynamic Width**: Auto-adjusts to content with appropriate padding
- **Screen Width Protection**: Never exceeds viewport boundaries

### ‚úÖ **Mobile Responsive Inventory Table** üÜï
- **Hidden Snapshot ID Column**: Automatically detects and removes ID columns from display
- **Human-Readable Timestamps**: Converts ISO timestamps to user-friendly format (e.g., "Aug 21, 2025 at 8:15 AM")
- **Latest 10 Rows Display**: Shows only the most recent inventory data for better performance
- **Horizontal Scrolling**: Table scrolls horizontally on mobile without exceeding container boundaries
- **Responsive Button Layout**: Refresh and Clear buttons maintain same-line layout on all screen sizes
- **Container Width Protection**: Table never exceeds its container width including padding/margins
- **Mobile-First Design**: Optimized for mobile devices with touch-friendly interactions

### ‚úÖ **Responsive Sales Channel Buttons** üÜï
- **Grid Layout on Mobile**: Maintains organized grid structure while allowing button wrapping
- **Auto-fit Columns**: Automatically adjusts number of columns based on available screen width
- **Smart Wrapping**: Buttons wrap to additional rows when they exceed container width
- **Container Boundary Respect**: Never exceeds container width on any screen size
- **Dynamic Sizing**: Buttons adapt to different screen sizes with consistent spacing
- **Clean Header Design**: Simplified page header without unnecessary icons

### ‚úÖ **Collapsible Sections System** üÜï
- **Individual Section Management**: Each form section operates independently with no nesting
- **Default Collapsed State**: All sections start collapsed by default for clean interface
- **Single Section Expansion**: Only one section can be expanded at a time
- **Smooth Icon Transitions**: Chevron icons smoothly change between up/down states
- **Click to Toggle**: Section headers are clickable with clear visual feedback
- **Professional Styling**: Clean borders, hover effects, and smooth animations
- **Mobile Responsive**: Touch-friendly interactions on all device sizes
- **Preserved Functionality**: All existing forms, search, and features work exactly as before

### ‚úÖ **Performance Optimizations**
- **Centralized Product Loading**: Single API call for all sections (75% reduction in API calls)
- **Dynamic Search States**: Real-time loading indicators across all sections
- **Unified Search Experience**: Consistent behavior and styling across all forms
- **Eliminated Redundancy**: Removed duplicate code and unnecessary UI elements

### ‚úÖ **User Experience Improvements**
- **Cleaner Interface**: Removed search tips and unnecessary buttons
- **Consistent Design**: Unified form styling and behavior patterns
- **Smart Validation**: Frontend validation preventing negative inputs
- **Real-time Feedback**: Toast notifications for all operations
- **Concise Messages**: Streamlined notification text for better readability

---

## üèóÔ∏è **System Architecture**

### **Frontend Technologies**
- **HTML5**: Semantic markup with modern form elements
- **CSS3**: Custom design system with CSS variables and responsive design
- **JavaScript (ES6+)**: Modular architecture with event-driven interactions
- **Material Icons**: Consistent iconography throughout the interface

### **Backend Integration**
- **Google Apps Script (GAS)**: RESTful API endpoints for inventory operations
- **Google Sheets**: Data storage and management
- **Fetch API**: Asynchronous communication with backend services

### **Data Flow**
```
User Input ‚Üí Frontend Validation ‚Üí API Request ‚Üí GAS Processing ‚Üí Sheet Update ‚Üí Response ‚Üí Toast Notification ‚Üí UI Update
```

---

## üé® **Design System Implementation**

### **CSS Architecture**
- **`design-system.css`**: Global variables, typography, and spacing
- **`icons.css`**: Material Icons integration
- **`main.css`**: Component-specific styles, utilities, toast notifications, and collapsible sections

### **Toast Notification Design**
- **Single-Line Layout**: 40px height for compact appearance
- **Dark Gray Background**: #1a1a1a for professional look
- **White Text**: High contrast for readability
- **Green Circled Success Icons**: #4CAF50 for positive feedback
- **Pill Shape**: 50px border radius for modern aesthetics
- **Centered Content**: Perfect horizontal and vertical centering
- **Dynamic Width**: Auto-fits content with fit-content sizing
- **Responsive Design**: Adapts to mobile and desktop screens
- **Screen Boundaries**: Never exceeds viewport width

### **Key Design Principles**
- **Mobile-First**: Responsive design starting from mobile devices
- **Consistent Spacing**: CSS custom properties for uniform spacing
- **Accessible Colors**: High contrast ratios and semantic color usage
- **Modular Components**: Reusable CSS classes and patterns
- **Toast-First UX**: Non-intrusive notifications that don't block the interface

---

## ‚ö° **Core Functionality**

### **Product Management**
- **Dynamic Search**: Real-time product search with fuzzy matching
- **SKU Validation**: Comprehensive product identification system
- **Location Management**: Shop and warehouse location handling
- **Stock Tracking**: Real-time inventory level monitoring

### **Inventory Operations**
- **Receiving**: Add new stock with supplier information
- **Transfer**: Move stock between locations with audit trail
- **Adjustment**: Set exact stock levels with current stock display
- **Sales**: Bulk sales processing with dynamic table management and sales channel tracking

### **Data Validation**
- **Frontend Validation**: Client-side input validation and sanitization
- **Business Rules**: Inventory-specific validation logic
- **Error Handling**: Graceful error display via toast notifications
- **User Feedback**: Real-time validation feedback

---

## üöÄ **UI Features**

### **Search & Navigation**
- **Smart Search**: Fuzzy search algorithm with relevance scoring
- **Dynamic Results**: Real-time search result updates
- **Keyboard Navigation**: Arrow keys and Enter/Esc support
- **Loading States**: Visual feedback during data operations

### **Form Management**
- **Auto-completion**: Intelligent form field population
- **Validation Feedback**: Real-time error and success indicators
- **Responsive Layouts**: Adaptive form layouts for all screen sizes
- **Accessibility**: ARIA labels and keyboard navigation support
- **Bulk Processing**: Dynamic table management for multiple record input
- **Collapsible Sections**: Expandable/collapsible form sections with smooth animations

### **Toast Notifications** üÜï
- **Success Messages**: Concise confirmation of completed operations
- **Error Messages**: Clear error reporting with actionable information
- **Warning Messages**: Validation and user guidance notifications
- **Info Messages**: General information and status updates
- **Progress Indicators**: Visual countdown bars for auto-dismiss
- **Smart Deduplication**: Prevents identical toast spam

### **Inventory Table Features** üÜï
- **Smart Column Filtering**: Automatically detects and hides system columns (SnapshotID)
- **Timestamp Formatting**: Converts ISO timestamps to human-readable format
- **Data Limiting**: Shows only latest 10 inventory records for optimal performance
- **Responsive Scrolling**: Horizontal scroll on mobile maintains container boundaries
- **Clean Data Display**: Focuses on essential inventory information only

### **Sales Channel Button Features** üÜï
- **Responsive Grid Layout**: Auto-fit columns that adapt to screen width
- **Smart Wrapping System**: Buttons automatically wrap to new rows when needed
- **Container Width Protection**: Never exceeds parent container boundaries
- **Consistent Spacing**: Maintains uniform gaps between all buttons
- **Mobile Optimization**: Touch-friendly button sizes on all devices

### **Status Indicators**
- **Connection Status**: Real-time backend connectivity monitoring
- **Loading Indicators**: Spinner animations for async operations
- **Success/Error States**: Clear visual feedback for all operations
- **Progress Tracking**: Visual progress indicators for long operations

---

## üì± **Responsive Design**

### **Breakpoint Strategy**
- **Mobile**: 320px - 768px (primary focus)
- **Tablet**: 768px - 1024px
- **Desktop**: 1024px+ (enhanced features)

### **Adaptive Components**
- **Flexible Grids**: CSS Grid and Flexbox for responsive layouts
- **Touch-Friendly**: Optimized touch targets for mobile devices
- **Progressive Enhancement**: Core functionality works on all devices
- **Performance**: Optimized loading for mobile networks
- **Toast Positioning**: Centered positioning across all screen sizes
- **Dynamic Sizing**: Toast width adapts to content on all devices

---

## üîß **Development Guidelines**

### **Code Standards**
- **Modular Architecture**: Separate concerns and maintainable code
- **ES6+ Features**: Modern JavaScript with proper error handling
- **CSS Best Practices**: BEM methodology and CSS custom properties
- **Performance First**: Optimize for speed and user experience
- **Toast Integration**: Consistent notification patterns across all operations

### **Testing & Quality**
- **Cross-Browser Testing**: Ensure compatibility across major browsers
- **Mobile Testing**: Validate on various mobile devices and screen sizes
- **Performance Testing**: Monitor API response times and page load speeds
- **User Experience Testing**: Validate intuitive navigation and workflows
- **Toast Testing**: Verify notification behavior and deduplication

---

## üìö **Technical Documentation**

### **API Endpoints**
- **`getProducts`**: Retrieve product master list
- **`getInventory`**: Get current inventory levels
- **`addStock`**: Add new stock to inventory
- **`transferStock`**: Move stock between locations
- **`adjustStock`**: Set exact stock levels
- **`addInventoryLog`**: Unified endpoint for all inventory operations including bulk sales processing

### **JavaScript Functions**
- **`loadAllProducts()`**: Centralized product loading for all sections
- **`setupProductSearch()`**: Initialize search functionality
- **`showSearchResults()`**: Display search results with relevance scoring
- **`checkAndShowCurrentStock()`**: Real-time stock level checking
- **`addSalesRecord()`**: Add sales records to dynamic table
- **`updateSalesRecordsTable()`**: Manage sales table display and validation
- **`submitBulkSales()`**: Process bulk sales data through unified API
- **`displaySnapshot()`**: Render inventory table with smart column filtering and timestamp formatting
- **`formatLastUpdated()`**: Convert ISO timestamps to human-readable format
- **`setupCollapsibleSections()`**: Initialize collapsible section functionality
- **`toggleSection(sectionId)`**: Handle section expand/collapse
- **`expandSection(sectionId)`**: Expand specific section and collapse others
- **`collapseSection(sectionId)`**: Collapse specific section
- **`collapseAllSections()`**: Close all sections

### **Toast Notification Functions** üÜï
- **`showToast(type, title, message, duration)`**: Core toast display function
- **`showSuccess(message, duration)`**: Success notification helper
- **`showError(message, duration)`**: Error notification helper
- **`showWarning(message, duration)`**: Warning notification helper
- **`showInfo(message, duration)`**: Info notification helper
- **Toast Deduplication**: Prevents duplicate notifications
- **Toast Management**: Maximum 3 concurrent toasts

### **CSS Classes**
- **`.form-section`**: Section container styling
- **`.search-container`**: Search input wrapper
- **`.current-stock-display`**: Stock level indicator
- **`.loading-spinner-small`**: Loading animation
- **`.sales-input-row`**: Horizontal input layout for sales records
- **`.sales-records-table`**: Dynamic table for bulk sales management
- **`.sales-channel-buttons`**: Responsive sales channel selection buttons
- **`.toast`**: Base toast notification styling
- **`.toast-success`**: Success toast variant
- **`.toast-error`**: Error toast variant
- **`.toast-warning`**: Warning toast variant
- **`.toast-info`**: Info toast variant
- **`.inventory-table-container`**: Responsive container for inventory table with horizontal scroll
- **`.inventory-table`**: Main inventory table styling with mobile-responsive design
- **`.form-section-actions`**: Responsive button container for form section actions
- **`.sales-channel-buttons`**: Base styling for sales channel button containers
- **`.sales-channel-buttons-desktop`**: Desktop-specific button layout with horizontal flexbox
- **`.sales-channel-buttons-mobile`**: Mobile-specific button layout with responsive grid
- **`.form-section-description`**: Styling for form section descriptive text
- **`.collapsible-section`**: Main collapsible section container
- **`.section-header`**: Clickable section header with hover effects
- **`.section-content`**: Collapsible content area with smooth transitions
- **`.section-expanded`**: Expanded section state styling
- **`.section-collapsed`**: Collapsed section state styling
- **`.chevron-icon`**: Expand/collapse indicator with smooth transitions

---

## üéØ **Project Goals**

### **Primary Objectives**
- **User Experience**: Intuitive and efficient inventory management with collapsible sections
- **Performance**: Fast loading and responsive interactions
- **Reliability**: Robust error handling and data validation
- **Maintainability**: Clean, documented, and modular code
- **Notification UX**: Non-intrusive, informative feedback system
- **Interface Organization**: Clean, organized interface with expandable sections

### **Success Metrics**
- **Page Load Time**: < 2 seconds on mobile networks
- **API Response Time**: < 500ms for all operations
- **User Error Rate**: < 5% for common operations
- **Code Coverage**: > 90% for critical functions
- **Toast Effectiveness**: Clear user feedback for all operations

---

## üîÆ **Next Development Phases**

### **Phase 5: Advanced Features**
- **Barcode Scanning**: Mobile camera integration for SKU input
- **Offline Support**: Service worker for offline functionality
- **Advanced Reporting**: Inventory analytics and reporting dashboard
- **User Management**: Role-based access control and permissions

### **Phase 6: Integration & Deployment**
- **Third-party APIs**: Integration with shipping and accounting systems
- **Production Deployment**: Live environment setup and monitoring
- **Performance Monitoring**: Real-time performance tracking
- **User Training**: Documentation and training materials

---

## üìù **Change Log**

### **Latest Updates (no date needed)** üÜï
- ‚úÖ **Collapsible Sections System**: Individual form sections with expand/collapse functionality
- ‚úÖ **Individual Section Management**: Each section operates independently with no nesting
- ‚úÖ **Default Collapsed State**: All sections start collapsed by default for clean interface
- ‚úÖ **Single Section Expansion**: Only one section can be expanded at a time
- ‚úÖ **Smooth Icon Transitions**: Chevron icons smoothly change between up/down states
- ‚úÖ **Click to Toggle**: Section headers are clickable with clear visual feedback
- ‚úÖ **Professional Styling**: Clean borders, hover effects, and smooth animations
- ‚úÖ **Mobile Responsive**: Touch-friendly interactions on all device sizes
- ‚úÖ **Preserved Functionality**: All existing forms, search, and features work exactly as before
- ‚úÖ **Responsive Sales Channel Buttons**: Grid layout with auto-fit columns and smart wrapping
- ‚úÖ **Grid Layout on Mobile**: Maintains organized structure while allowing button wrapping
- ‚úÖ **Auto-fit Columns**: Automatically adjusts number of columns based on screen width
- ‚úÖ **Smart Wrapping System**: Buttons wrap to additional rows when exceeding container width
- ‚úÖ **Container Boundary Respect**: Never exceeds container width on any screen size
- ‚úÖ **Clean Header Design**: Simplified page header without unnecessary icons
- ‚úÖ **Mobile Responsive Inventory Table**: Smart column filtering and human-readable timestamps
- ‚úÖ **Hidden Snapshot ID Column**: Automatically detects and removes system columns from display
- ‚úÖ **Timestamp Formatting**: Converts ISO timestamps to user-friendly format (e.g., "Aug 21, 2025 at 8:15 AM")
- ‚úÖ **Latest 10 Rows Display**: Shows only most recent inventory data for optimal performance
- ‚úÖ **Horizontal Scrolling**: Table scrolls horizontally on mobile without exceeding container boundaries
- ‚úÖ **Responsive Button Layout**: Refresh and Clear buttons maintain same-line layout on all screen sizes
- ‚úÖ **Container Width Protection**: Table never exceeds container width including padding/margins
- ‚úÖ **Mobile-First Design**: Optimized for mobile devices with touch-friendly interactions
- ‚úÖ **Toast Notification System**: Floating, pill-shaped notifications with dark gray theme
- ‚úÖ **Single-Line Messages**: Concise, space-efficient notification text
- ‚úÖ **Duplicate Prevention**: Smart deduplication prevents multiple identical toasts
- ‚úÖ **Sales Section Integration**: All sections now use consistent toast notifications
- ‚úÖ **Professional Styling**: Dark gray background (#1a1a1a), white text, green circled success icons
- ‚úÖ **Mobile-Optimized**: Responsive toast positioning for all screen sizes
- ‚úÖ **Centered Positioning**: Horizontally centered on all devices (desktop, mobile, tablet)
- ‚úÖ **Dynamic Width**: Auto-adjusts to content with appropriate padding
- ‚úÖ **Screen Protection**: Never exceeds viewport boundaries

### **Previous Milestones**
- ‚úÖ **Performance Optimization**: Centralized product loading (75% API call reduction)
- ‚úÖ **UI Cleanup**: Removed unnecessary buttons and search tips
- ‚úÖ **Search Unification**: Consistent search behavior across all sections
- ‚úÖ **Code Refactoring**: Eliminated duplicate functions and improved maintainability
- ‚úÖ **Current Stock Display**: Real-time stock level indicators in adjustment section
- ‚úÖ **Sales Section Redesign**: Bulk processing with dynamic table and sales channel integration
- ‚úÖ **Responsive Design**: Mobile-optimized input layouts with horizontal alignment on desktop

---

## üöÄ **Getting Started**

### **Prerequisites**
- Modern web browser with ES6+ support
- Google Apps Script backend deployment
- Product master data in Google Sheets

### **Setup Instructions**
1. Deploy the GAS backend code
2. Configure Google Sheets with proper structure
3. Update API endpoints in frontend code
4. Test all inventory operations and toast notifications
5. Deploy to production environment

---

## üìû **Support & Maintenance**

### **Development Team**
- **Lead Developer**: [Your Name]
- **Product Manager**: [PM Name]
- **QA Engineer**: [QA Name]

### **Maintenance Schedule**
- **Weekly**: Performance monitoring and bug fixes
- **Monthly**: Feature updates and security patches
- **Quarterly**: Major version releases and documentation updates

---

*This document serves as the comprehensive guide for PM Inventory System V4 development and maintenance.*
